(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{125:function(e,t,n){},126:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(27),i=n.n(o),s=n(11),c=n(9),l=n(30),u=n(59),p=n(60),d=n.n(p),g=n(13),h={selectedDate:new Date,where:"sydney"},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"DATE_SELECTED":return Object(g.a)({},e,{selectedDate:t.payload});case"WHERE_SELECTED":return Object(g.a)({},e,{where:t.payload});case"GIGS_POPULATED":return Object(g.a)({},e,{gigs:t.payload});case"SPOTIFY_TOKEN":return Object(g.a)({},e,{spotifyToken:t.payload});default:return e}},f={key:"root",storage:d.a,whitelist:["selectedDate","where","gigs","spotifyToken"]},y=Object(l.a)(f,m),w=n(29),D=n(12),S=n(14),A=n(15),E=n(17),v=n(16),k=n(18),_=n(61),b=n.n(_),C=n(23),O=n.n(C),j=(n(95),function(e){function t(){var e,n;Object(S.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(E.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).state={selectedDate:new Date,showCalendar:!1},n.changeDateHandler=function(e){n.setState({selectedDate:e,showCalendar:!1}),n.props.onDateSelected(n.state.selectedDate)},n}return Object(k.a)(t,e),Object(A.a)(t,[{key:"render",value:function(){var e=this,t="".concat(this.state.selectedDate.toLocaleDateString("en-US",{weekday:"short"})," ").concat(this.state.selectedDate.toLocaleDateString("en-US",{day:"2-digit"})," ").concat(this.state.selectedDate.toLocaleDateString("en-US",{month:"short"})),n="".concat((new Date).toLocaleDateString("en-US",{weekday:"short"})," ").concat((new Date).toLocaleDateString("en-US",{day:"2-digit"})," ").concat((new Date).toLocaleDateString("en-US",{month:"short"})),o="".concat((new Date).toLocaleDateString("en-US",{weekday:"short"})," ").concat(new Date((new Date).setDate((new Date).getDate()+1)).toLocaleDateString("en-US",{day:"2-digit"})," ").concat((new Date).toLocaleDateString("en-US",{month:"short"})),i="".concat((new Date).toLocaleDateString("en-US",{weekday:"short"})," ").concat(new Date((new Date).setDate((new Date).getDate()-1)).toLocaleDateString("en-US",{day:"2-digit"})," ").concat((new Date).toLocaleDateString("en-US",{month:"short"})),s="";t.slice(4)===n.slice(4)?s="Today - ":t.slice(4)===o.slice(4)?s="Tomorrow - ":t.slice(4)===i.slice(4)&&(s="Yesterday - ");var c=[O.a.calendarContainer];return this.state.showCalendar&&c.push(O.a.showCalendar),r.a.createElement(a.Fragment,null,r.a.createElement("div",{className:O.a.container,onClick:function(){return e.setState(function(e){return{showCalendar:!e.showCalendar}})}},r.a.createElement("h3",null,"".concat(s).concat(t))),r.a.createElement("div",{className:c.join(" ")},r.a.createElement(b.a,{onChange:this.changeDateHandler,value:this.state.selectedDate,className:O.a.calendar,minDetail:"year",minDate:new Date((new Date).setMonth((new Date).getMonth()-3)),maxDate:new Date((new Date).setMonth((new Date).getMonth()+3))})))}}]),t}(a.Component)),T=Object(c.b)(null,function(e){return{onDateSelected:function(t){return e({type:"DATE_SELECTED",payload:t})}}})(j),U=n(66),G=n(19),L=n.n(G),I=n(62),P=n.n(I),N=n(63),H=n.n(N),B=n(31),M=n.n(B),x=function(e){var t="";e.artist.length>50&&(t="...");var n="url(".concat(P.a,")");e.image&&(n="url(".concat(e.image,")"));var a=[M.a.container];e.selected||a.push(M.a.unselected);var o="";return e.onSpotify||(o=r.a.createElement("div",{className:M.a.notAvailableCross,style:{backgroundImage:"url(".concat(H.a,")")}})),r.a.createElement("div",{className:a.join(" "),style:{backgroundImage:n},onClick:function(){e.onSpotify&&e.toggleSelectGig(e.id)}},r.a.createElement("h3",null,e.artist.slice(0,50)+t),r.a.createElement("h4",null,e.venue),o)},Y=n(64),F=n.n(Y),Z=function(e){return r.a.createElement("div",{className:F.a["lds-ellipsis"]},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null))},J=n(32),W=n.n(J),z=function(e){function t(){var e,n;Object(S.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(E.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).state={gigs:[],spotifyToken:null,errorMessage:null},n.getGigs=function(){L.a.post("https://gigwigs-server.herokuapp.com/getGigs",{where:n.props.where,selectedDate:"".concat(new Date(n.props.selectedDate).getFullYear(),"-").concat(new Date(n.props.selectedDate).toLocaleDateString("en-US",{month:"short"}),"-").concat(new Date(n.props.selectedDate).toLocaleDateString("en-US",{day:"2-digit"}))}).then(function(e){var t=e.data.gigs;n.setState({gigs:t}),n.getSpotifyOAuthToken()}).catch(function(e){return n.errorhandler(e)})},n.getSpotifyOAuthToken=function(){L.a.get("https://gigwigs-server.herokuapp.com/spotifyAuth").then(function(e){n.setState({spotifyToken:e.data.token}),n.getImages(),n.props.onGetSpotifyToken(n.state.spotifyToken)}).catch(function(e){return n.errorhandler(e)})},n.getImages=function(){var e=[];n.state.gigs.forEach(function(a){L.a.get("https://api.spotify.com/v1/search?type=artist",{params:{q:a.title},headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+n.state.spotifyToken}}).then(function(n){var r=n.data.artists.items[0].images[1].url,o=n.data.artists.items[0].id,i=Object(g.a)({},a,{image:r,spotifyArtistId:o});e.push(i),t()}).catch(function(){e.push(a),t()})});var t=function(){e.length===n.state.gigs.length&&(n.setState({gigs:e}),n.props.onGigsPopulated(n.state.gigs))}},n.toggleSelectGigHandler=function(e){var t=Object(U.a)(n.state.gigs);t.forEach(function(n,a){n.id===e&&(t[a].selected=!t[a].selected)}),n.setState({gigs:t}),n.props.onGigsPopulated(n.state.gigs)},n.errorhandler=function(e){n.setState({errorMessage:"Something went wrong, the app will refresh shortly... (".concat(e,")")})},n}return Object(k.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){this.getGigs()}},{key:"componentDidUpdate",value:function(e){this.props.selectedDate!==e.selectedDate&&(this.setState({gigs:[]}),this.getGigs())}},{key:"render",value:function(){var e=this,t=null;return t=0===this.state.gigs.length?r.a.createElement("div",{className:W.a.spinnerContainer},r.a.createElement(Z,null)):this.state.gigs.map(function(t){return r.a.createElement(x,{key:t.id,id:t.id,artist:t.artist,venue:t.venue,image:t.image,selected:t.selected,toggleSelectGig:e.toggleSelectGigHandler,onSpotify:t.spotifyArtistId})}),this.state.errorMessage&&(t=r.a.createElement("div",{className:W.a.errorContainer},r.a.createElement("div",null,r.a.createElement("h4",null,this.state.errorMessage)))),r.a.createElement("div",{className:W.a.container},t)}}]),t}(a.Component),X=Object(D.g)(Object(c.b)(function(e){return{selectedDate:e.selectedDate,where:e.where}},function(e){return{onGigsPopulated:function(t){return e({type:"GIGS_POPULATED",payload:t})},onGetSpotifyToken:function(t){return e({type:"SPOTIFY_TOKEN",payload:t})}}})(z)),V=n(22),Q=n.n(V),R=n(39),K=n.n(R),q=Object(c.b)(function(e){return{gigs:e.gigs}})(function(e){var t=!1,n=[K.a.container];e.gigs.some(function(e){return void 0!==e.spotifyArtistId&&!0===e.selected})&&(t=!0,n.push(K.a.enabled));var a=new Q.a({redirectUri:"https://pkpkpkpkpkpkpkpk.github.io/gigwigs/playlist",clientId:"e395299ea7a84cf2b3833d140e0fb40f"}).createAuthorizeURL(["playlist-modify-public"]);return r.a.createElement("div",{className:n.join(" "),onClick:function(){t&&(window.location.href=a)}},r.a.createElement("h3",null,"Create Playlist"))}),$=function(e){return r.a.createElement(a.Fragment,null,r.a.createElement(T,null),r.a.createElement(X,null),r.a.createElement(q,null))},ee=n(40),te=n.n(ee),ne=function(e){function t(){var e,n;Object(S.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(E.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).state={spotifyUserId:null,spotifyUserToken:null,message:null},n.errorHandler=function(e){n.setState({message:"Something went wrong, you'll be redirected shortly... (".concat(e,")")}),setTimeout(function(){return n.props.history.replace("/")},3e3)},n}return Object(k.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=new Q.a({redirectUri:"https://pkpkpkpkpkpkpkpk.github.io/gigwigs/playlist",clientId:"e395299ea7a84cf2b3833d140e0fb40f"}),n=this.props.gigs.map(function(e){return e.selected?e.spotifyArtistId:void 0}).filter(function(e){return void 0!==e});t.setAccessToken(this.props.spotifyToken);var a=[];n.forEach(function(n){t.getArtistTopTracks(n,"AU").then(function(e){a.push(e.body.tracks[e.body.tracks.length-1].uri),a.push(e.body.tracks[1].uri)},function(t){return e.errorHandler(t)})});var r=this.props.location.search.slice(6);L.a.post("https://gigwigs-server.herokuapp.com/spotifyUserAuth",{authCode:r}).then(function(t){e.setState({spotifyUserToken:t.data.userToken});var n=new Q.a({accessToken:e.state.spotifyUserToken});n.getMe().then(function(t){e.setState({spotifyUserId:t.body.id}),n.createPlaylist(e.state.spotifyUserId,"Gigs - ".concat(new Date(e.props.selectedDate).toLocaleDateString("en-US",{day:"2-digit"})," ").concat(new Date(e.props.selectedDate).toLocaleDateString("en-US",{month:"short"})," - ").concat(e.props.where.charAt(0).toUpperCase()).concat(e.props.where.slice(1)),{description:"Playlist by GigWigs"}).then(function(t){var r=t.body.id;n.addTracksToPlaylist(r,a).then(function(t){e.setState({message:"Playlist created! Check Spotify..."}),setTimeout(function(){return e.props.history.replace("/")},3e3)},function(t){return e.errorHandler(t)})},function(t){return e.errorHandler(t)})},function(t){return e.errorHandler(t)})}).catch(function(t){return e.errorHandler(t)})}},{key:"render",value:function(){var e=r.a.createElement(Z,null);return this.state.message&&(e=r.a.createElement("div",{className:te.a.messageContainer},r.a.createElement("h4",null,this.state.message))),r.a.createElement("div",{className:te.a.container},e)}}]),t}(a.Component),ae=Object(D.g)(Object(c.b)(function(e){return{gigs:e.gigs,spotifyToken:e.spotifyToken,selectedDate:e.selectedDate,where:e.where}})(ne)),re=function(){return r.a.createElement(w.a,{basename:"/gigwigs"},r.a.createElement(D.d,null,r.a.createElement(D.b,{path:"/",exact:!0,component:$}),r.a.createElement(D.b,{path:"/playlist",exact:!0,component:ae}),r.a.createElement(D.a,{from:"/",to:"/"})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(125);var oe=Object(s.c)(y,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),ie=Object(l.b)(oe);i.a.render(r.a.createElement(c.a,{store:oe},r.a.createElement(u.a,{loading:null,persistor:ie},r.a.createElement(re,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},23:function(e,t,n){e.exports={container:"DateSelector_container__ZZw8A",calendarContainer:"DateSelector_calendarContainer__5Hnt2",showCalendar:"DateSelector_showCalendar__agVkl",calendar:"DateSelector_calendar__1guTQ"}},31:function(e,t,n){e.exports={container:"Gig_container__2J0ux",unselected:"Gig_unselected__3r8QZ",notAvailableCross:"Gig_notAvailableCross__32nBC"}},32:function(e,t,n){e.exports={container:"Gigs_container__1gXHw",spinnerContainer:"Gigs_spinnerContainer__YXysz",errorContainer:"Gigs_errorContainer__GtkAe"}},39:function(e,t,n){e.exports={container:"CreatePlaylistButton_container__2RSxm",enabled:"CreatePlaylistButton_enabled__C_sjU"}},40:function(e,t,n){e.exports={container:"PlaylistCreator_container__2bxle",messageContainer:"PlaylistCreator_messageContainer__GxS54"}},62:function(e,t,n){e.exports=n.p+"static/media/gig-image.be70d568.jpg"},63:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAEBgAABAYBmSDe8AAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAHMSURBVGiB7ZjNTttAFIU/9V3YwCMAUleoJZsKCOmiUMEmIW+eZdtFq4TksLGl29HMVBnPj4t8JC9ijc85n69GmhgmTZo06V1JcCJYNMxfCE6GmpwJNoKDYJ2p2zH56y57IzhLNekh1F0HwUvmrrH8HqLP3whOU4wWgldjpO73twK93eyHQPZ9quGdYOcYFp2M4MWZhARbwd1Q42owAYjdYAgTUBymOIQJCsGsMnjXgTCB2WGqQ5jgeS6YZhCmwGAYwaophCmSDBOBmNfo7it0NMzoIEyxEMzSs3acEL0E9/+CGT1ErwDMXvBdsPwvIHoJnrvybmH3ALgXPLXuG1VgMi5Y2im2tiIwxSA+lDAFDoH7AvaFMvNK8OjZE+4fpIfWPaOS/1Dp2+xbwW3rvl4FJvFHMBPcdOXHPZkYhFkzbpgIxLVn7ThhjoEwz4wLJgXCPDsOmAjE5yM82sLkgDBebWByQhjPujABiN9DIIx3HZiSECajLEwE4lOWgL+zysDUhDCZs27fuTCPqYa+jwpbwU3m7r7sr54XmPbNS3Ap+FVrEp58dzI/BRepZhcdTFUIk9/D/BCcDzW7EnzJ1C0lfyH42Cp/0qRJk8roDbyxQjfkKp73AAAAAElFTkSuQmCC"},64:function(e,t,n){e.exports={"lds-ellipsis":"Spinner_lds-ellipsis__djSmW","lds-ellipsis1":"Spinner_lds-ellipsis1__3WP-A","lds-ellipsis2":"Spinner_lds-ellipsis2__3ao42","lds-ellipsis3":"Spinner_lds-ellipsis3__1hNdQ"}},67:function(e,t,n){e.exports=n(126)},95:function(e,t,n){}},[[67,1,2]]]);
//# sourceMappingURL=main.2b4e9f4b.chunk.js.map